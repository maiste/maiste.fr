<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Maiste.fr</title>
    <link rel="me" href="https://fosstodon.org/@maiste" />
    <link
      rel="alternate"
      type="application/rss+xml"
      title="RSS Feed for maiste.fr"
      href="/rss.xml"
    />

    <!-- Main CSS -->
    <link href="/static/css/main.css" rel="stylesheet" />

    <!-- Fonts -->
    <link href="/static/fonts/import.css" rel="stylesheet" />

    <!-- Code Highlighting -->
    <link href="/static/css/code.css" rel="stylesheet" type="text/css" />
    <script src="/static/script/highlight.min.js"></script>
  </head>

  <!-- Umami -->
  <script
    defer
    src="https://analytics.maiste.fr/script.js"
    data-website-id="b1e6219d-8044-47d9-9e91-44db862e2732"
    data-do-not-track="true"
  ></script>
  <!-- End Umami code -->

  <!-- Theme -->
  <script>
    let userTheme =
      localStorage.getItem("theme") ??
      (window.matchMedia("(prefers-color-scheme: light)").matches
        ? "light"
        : "dark");
    if (userTheme) {
      document.documentElement.setAttribute("data-theme", userTheme);
    }
    function switchTheme() {
      let currentTheme = document.documentElement.getAttribute("data-theme");
      let newTheme = currentTheme === "light" ? "dark" : "light";
      document.documentElement.setAttribute("data-theme", newTheme);
      localStorage.setItem("theme", newTheme);
    }
  </script>
  <!-- End Theme code -->

  <body>
    <header>
      <nav>
        <h2><a href="/">Maiste</a></h2>
        <ul>
          <li><a href="/about">About</a></li>
          <li><a href="/blog">Blog</a></li>
          <li><a href="/projects">Projects</a></li>
          <li><a href="/wiki">Wiki</a></li>
          <li>
            <button id="theme-toggle" onclick="switchTheme()">
              <svg
                id="theme-moon"
                width="23.977"
                xmlns="http://www.w3.org/2000/svg"
                height="24"
                fill="none"
              >
                <g class="feather feather-moon" style="fill: rgb(0, 0, 0)">
                  <path
                    d="M20.979,12.790C20.542,17.526,16.499,21.104,11.750,20.958C7.001,20.812,3.185,16.992,3.039,12.238C2.894,7.484,6.468,3.438,11.199,3.000C9.141,5.786,9.430,9.660,11.878,12.111C14.326,14.561,18.196,14.850,20.979,12.790ZZ"
                    fill="none"
                    style="fill: currentColor"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M20.979,12.790C20.542,17.526,16.499,21.104,11.750,20.958C7.001,20.812,3.185,16.992,3.039,12.238C2.894,7.484,6.468,3.438,11.199,3.000C9.141,5.786,9.430,9.660,11.878,12.111C14.326,14.561,18.196,14.850,20.979,12.790ZZ"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                </g>
              </svg>

              <svg
                id="theme-sun"
                width="24"
                xmlns="http://www.w3.org/2000/svg"
                height="24"
                fill="currentColor"
              >
                <g class="feather feather-sun">
                  <ellipse
                    cx="12"
                    cy="12"
                    rx="5"
                    ry="5"
                    transform="matrix(1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000)"
                    fill="currentColor"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <ellipse
                      cx="12"
                      cy="12"
                      rx="5"
                      ry="5"
                      transform="matrix(1.000000, 0.000000, 0.000000, 1.000000, 0.000000, 0.000000)"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M12.000,1.000L12.000,3.000"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M12.000,1.000L12.000,3.000"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M12.000,21.000L12.000,23.000"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M12.000,21.000L12.000,23.000"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M4.220,4.220L5.640,5.640"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M4.220,4.220L5.640,5.640"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M18.360,18.360L19.780,19.780"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M18.360,18.360L19.780,19.780"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M1.000,12.000L3.000,12.000"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M1.000,12.000L3.000,12.000"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M21.000,12.000L23.000,12.000"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M21.000,12.000L23.000,12.000"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M4.220,19.780L5.640,18.360"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M4.220,19.780L5.640,18.360"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                  <path
                    d="M18.360,5.640L19.780,4.220"
                    fill="none"
                    style="fill: currentColor; fill-opacity: 0"
                    class="fills"
                  />
                  <g fill="none" stroke-linejoin="round" class="strokes">
                    <path
                      d="M18.360,5.640L19.780,4.220"
                      style="
                        fill: none;
                        stroke-width: 2;
                        stroke: currentColor;
                        stroke-opacity: 1;
                      "
                      class="stroke-shape"
                    />
                  </g>
                </g>
              </svg>
            </button>
          </li>
        </ul>
      </nav>
    </header>

    <main>
      <div class="container"><h1>Sys Admin</h1>
<div class="metadata"><p>description: Resources about Sys Admin - Messy, needs to be split</p><p>lang: ENG
    </p>
</div>
<div class="content"><h2 id="apps"><a class="anchor" aria-hidden="true" href="#apps"></a>Apps</h2>
<h3 id="resources"><a class="anchor" aria-hidden="true" href="#resources"></a>Resources</h3>
<ul>
<li><a href="https://syncthing.net/">Syncthing</a>: tool to keep sync up to date</li>
<li><a href="https://nextcloud.com/">Nextcloud</a>: cloud interface</li>
</ul>
<hr />
<h2 id="backup"><a class="anchor" aria-hidden="true" href="#backup"></a>Backup</h2>
<ul>
<li>rsync: backup tool</li>
</ul>
<pre><code class="language-sh">  # a is for archive, v for verbose, h for human and p for partial
  rsync -avhp src/ dest/
</code></pre>
<hr />
<h3 id="resources-1"><a class="anchor" aria-hidden="true" href="#resources-1"></a>Resources</h3>
<ul>
<li><a href="https://rclone.org/docs/">Rclone</a>: a tool to manage backup with cloud providers</li>
<li><a href="https://www.scaleway.com/en/docs/tutorials/migrate-data-rclone/">Object Storage - Scaleway</a>: how to use Object Storage and Rclone with Scaleway</li>
<li><a href="https://www.scaleway.com/en/docs/tutorials/encrypt-s3-data-rclone/">Encrypted Object Storage - Scaleway</a>: how to use object storage with encrypted buckets</li>
</ul>
<h2 id="block-connections-on-22-port"><a class="anchor" aria-hidden="true" href="#block-connections-on-22-port"></a>Block connections on 22 port</h2>
<p>Use the tool <em>endlessh</em></p>
<hr />
<h2 id="filesystem"><a class="anchor" aria-hidden="true" href="#filesystem"></a>FileSystem</h2>
<h3 id="create-swap-memory"><a class="anchor" aria-hidden="true" href="#create-swap-memory"></a>Create swap memory</h3>
<ul>
<li>First, you need to create the file:</li>
</ul>
<pre><code class="language-bash">sudo dd if=/dev/zero of=/swapfile bs=1024 count=1000000
</code></pre>
<ul>
<li>Then, format the swap file:</li>
</ul>
<pre><code class="language-bash">sudo mkswap /swapfile
</code></pre>
<ul>
<li>After that, restrict the permission:</li>
</ul>
<pre><code>sudo chmod 600 /swapfile
</code></pre>
<ul>
<li>Activate the swap:</li>
</ul>
<pre><code>sudo swapon /swapfile
</code></pre>
<ul>
<li>(Optional) Depending if you need to have it online when you restart the computer, you need to edit <code>/etc/fstab</code> as follow:</li>
</ul>
<pre><code class="language-bash"># FS          mountpoint  type  option(s) dump pass
/path/to/swap    none     swap      sw      0    0
</code></pre>
<h3 id="resources-2"><a class="anchor" aria-hidden="true" href="#resources-2"></a>Resources</h3>
<ul>
<li><a href="https://unix.stackexchange.com/questions/672151/create-zfs-partition-on-existing-drive">ZFS partition</a>: how to create a ZFS partition</li>
</ul>
<hr />
<h2 id="firewall"><a class="anchor" aria-hidden="true" href="#firewall"></a>Firewall</h2>
<h3 id="resources-3"><a class="anchor" aria-hidden="true" href="#resources-3"></a>Resources</h3>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/ufw-essentials-common-firewall-rules-and-commands">UFW beginner guide</a></li>
</ul>
<hr />
<h2 id="nginx"><a class="anchor" aria-hidden="true" href="#nginx"></a>Nginx</h2>
<h3 id="resources-4"><a class="anchor" aria-hidden="true" href="#resources-4"></a>Resources</h3>
<ul>
<li><a href="https://dev.to/danielkun/nginx-everything-about-proxypass-2ona">Proxy_pass</a>: tutorial about nginx <code>proxy_pass</code> directive</li>
</ul>
<hr />
<h2 id="ssh"><a class="anchor" aria-hidden="true" href="#ssh"></a>SSH</h2>
<h3 id="chroot-jail"><a class="anchor" aria-hidden="true" href="#chroot-jail"></a>Chroot jail</h3>
<h4 id="definition"><a class="anchor" aria-hidden="true" href="#definition"></a>Definition</h4>
<p>Use <em>chroot jail</em> wit SSH. It allows to isolate a user through ssh in a
specific directory with limited commands.</p>
<h3 id="resources-5"><a class="anchor" aria-hidden="true" href="#resources-5"></a>Resources</h3>
<ul>
<li><a href="https://allanfeid.com/content/creating-chroot-jail-ssh-access">chroot jail</a>: how to build a Chroot jail</li>
<li><a href="https://blog.octo.com/le-bastion-ssh/">Bastion SSH (FR)</a>: how to create a SSH bastion</li>
<li><a href="https://iximiuz.com/en/posts/ssh-tunnels/">Visual Guide to SSH Tunnels</a></li>
</ul>
<hr />
<h2 id="vpn"><a class="anchor" aria-hidden="true" href="#vpn"></a>VPN</h2>
<h3 id="resources-6"><a class="anchor" aria-hidden="true" href="#resources-6"></a>Resources</h3>
<ul>
<li><a href="https://fedoramagazine.org/build-a-virtual-private-network-with-wireguard/">Buil a VPN with Wireguard</a>: Fedora magazine post about how to build aVPN with Wireguard</li>
</ul>
<hr />
<h2 id="sudo--su"><a class="anchor" aria-hidden="true" href="#sudo--su"></a>Sudo &amp; su</h2>
<h2 id="su"><a class="anchor" aria-hidden="true" href="#su"></a>Su</h2>
<ul>
<li>Execute a command with the default shell for a specific user
<pre><code class="language-sh">su &lt;user&gt; -c &lt;command&gt;
</code></pre>
</li>
<li>Execute a specific shell for a specific user
<pre><code class="language-sh">su &lt;user&gt; -s &lt;shell&gt;
</code></pre>
</li>
</ul>
<h2 id="dns---protect-from-squatting"><a class="anchor" aria-hidden="true" href="#dns---protect-from-squatting"></a>DNS - Protect from squatting</h2>
<p>The DNS should have this if you don't want to host an email on your domain.</p>
<pre><code class="language-dns">MX 0 &quot;.&quot;
TXT v=spf1 -all
TXT v=DMARC1; p=reject;
</code></pre>
<p>The <code>MX</code> is to specify that there is no mail server in the domain. The first
<code>TXT</code> specifies that no mail server can send mail in your domain name. The last
one says that every mail saying they are sent on your behalf should be consider
as trash.</p>
<h2 id="upgrade-debian"><a class="anchor" aria-hidden="true" href="#upgrade-debian"></a>Upgrade Debian</h2>
<p>Make sure you have created your system backups and then proceed.</p>
<ul>
<li>First, you need to update your current system:</li>
</ul>
<pre><code class="language-sh">apt update &amp;&amp; apt upgrade
apt dist-upgrade
</code></pre>
<ul>
<li>Then, clean the cache and remove the unused packages:</li>
</ul>
<pre><code class="language-sh">apt clean &amp;&amp; apt autoremove
</code></pre>
<ul>
<li>Then, update the repositories in <code>/etc/apt/*.list</code> and replace the old version name with the new one. It tends to do it using vim but this is a script you can automatize.</li>
<li>Then update to the new repository:</li>
</ul>
<pre><code class="language-sh">apt update
</code></pre>
<ul>
<li>Then upgrade the packages without conflicts:</li>
</ul>
<pre><code class="language-sh">apt upgrade --without-new-pkgs
</code></pre>
<ul>
<li>Finally, run the full system upgrade:</li>
</ul>
<pre><code class="language-sh">apt full-upgrade
</code></pre>
</div>
</div>
    </main>

    <footer>
      <div class="container">
        <p>
          This site is part of the
          <a href="https://ring.muhokama.fun">Muhokama ring</a>
        </p>
        <p>
          (<a href="https://ring.muhokama.fun/u/maiste/pred">Previous</a> -
          <a href="https://ring.muhokama.fun/u/maiste/succ">Next</a>)
        </p>
        <p>
          Website written proudly with
          <a href="https://github.com/xhtmlboy/yocaml">Yocaml</a> â™¡
        </p>
      </div>
    </footer>
    <script>
      hljs.highlightAll();
    </script>
  </body>
</html>
